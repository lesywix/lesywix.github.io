<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://lesywix.github.io</id>
    <title>Lesywix</title>
    <updated>2020-03-02T16:44:50.159Z</updated>
    <generator>https://github.com/jpmonette/feed</generator>
    <link rel="alternate" href="https://lesywix.github.io"/>
    <link rel="self" href="https://lesywix.github.io/atom.xml"/>
    <subtitle>åšäº†ç‚¹å¾®å°çš„è´¡çŒ®ï¼Œè°¢è°¢å¤§å®¶</subtitle>
    <logo>https://lesywix.github.io/images/avatar.png</logo>
    <icon>https://lesywix.github.io/favicon.ico</icon>
    <rights>All rights reserved 2020, Lesywix</rights>
    <entry>
        <title type="html"><![CDATA[Git é‡å†™å†å²]]></title>
        <id>https://lesywix.github.io/post/git-chong-xie-li-shi/</id>
        <link href="https://lesywix.github.io/post/git-chong-xie-li-shi/">
        </link>
        <updated>2020-03-02T16:38:01.000Z</updated>
        <content type="html"><![CDATA[<h2 id="ä¿®æ”¹æœ€åä¸€æ¬¡æäº¤"><strong>ä¿®æ”¹æœ€åä¸€æ¬¡æäº¤</strong></h2>
<p>æœ‰çš„æ—¶å€™ä½ å¯èƒ½ä¼šæƒ³ä¿®æ”¹<strong>ä¸Šä¸€æ¬¡</strong>æäº¤çš„ä¿¡æ¯ï¼Œæˆ–è€…æ·»åŠ åˆ é™¤æŸäº›å¿˜è®°çš„æ–‡ä»¶ï¼Œé‚£ä¹ˆåœ¨<code>git add</code>ï¼ˆè‹¥æœ‰æ–‡ä»¶å˜æ›´ï¼‰å°†å¾…æ›´æ”¹çš„æ–‡ä»¶åŠ å…¥åå¯ä»¥ç®€å•çš„æ‰§è¡Œï¼š<code>git commit --amend</code><br>
è¿™æ—¶ä¼šè¿›å…¥ä¸Šæ¬¡ commit çš„æ–‡æœ¬ç¼–è¾‘å™¨ï¼ŒåŒ…å«ä½ ä¸Šæ¬¡æäº¤çš„ä¿¡æ¯ä¾›ä½ ä¿®æ”¹ã€‚ä½ åªéœ€è¦ä¿®æ”¹ä¸ºä½ æƒ³è¦çš„ä¿¡æ¯ç„¶åä¿å­˜å³å¯ï¼Œä¿å­˜é€€å‡ºåï¼Œåœ¨ log ä¸­å¯ä»¥å‘ç°æœ€è¿‘ä¸€æ¬¡æäº¤çš„ä¿¡æ¯å·²ç»è¢«æˆåŠŸæ›¿æ¢ï¼Œå¹¶ä¸” git hash ä¹Ÿå·²ç»æ”¹å˜ï¼ˆå˜åŸºæ“ä½œï¼‰ã€‚<br>
è‹¥å‰ä¸€æ¬¡çš„ commit å·²ç» push åˆ°è¿œç¨‹ä»“åº“ï¼Œæˆ‘ä»¬æ€ä¹ˆä¿®æ”¹è¿œç¨‹ä»“åº“ä¸Šæ¬¡çš„ commit å‘¢ï¼Ÿåªéœ€åœ¨ä¸Šä¸€æ­¥åŸºç¡€ä¸Šæ‰§è¡Œï¼š<code>git push --force</code>ï¼Œè¯¥æ“ä½œä¼šå°†æœ¬åœ°çš„æäº¤è¦†ç›–è¿œç¨‹ä»“åº“ä¸Šä¸€æ¬¡çš„ commitã€‚<br>
<strong>ç”±äºè¿™æ˜¯å˜åŸºæ“ä½œï¼Œä¼šè¦†ç›–å†å²ï¼Œç¡®ä¿æœ¬åœ°æ“ä½œåçš„ç»“æœæ˜¯è‡ªå·±æƒ³è¦çš„ã€‚</strong></p>
<p><strong>rebase é»„é‡‘æ³•åˆ™ï¼šnever use it on public branches. ä¸è¦åœ¨å…¬å…±çš„branchä¸Šä½¿ç”¨</strong></p>
<h3 id="example"><strong>Example:</strong></h3>
<p><code>git log</code>ä¸­å­˜åœ¨ä¸€ä¸ª commit ,æ­¤æ—¶ git ä»“åº“æœ‰ file_1.txt æ–‡ä»¶ï¼Œå¹¶ä¸”æœ‰æ–°å»ºçš„ file_2.txtï¼ˆå‡è®¾æ˜¯æˆ‘ä»¬åœ¨ä¸Šæ¬¡ commit ä¸­å¿˜è®°æ·»åŠ çš„æ–‡ä»¶ï¼‰</p>
<figure data-type="image" tabindex="1"><img src="https://i.loli.net/2019/04/29/5cc6fc5163289.jpg" alt="https://i.loli.net/2019/04/29/5cc6fc5163289.jpg" loading="lazy"></figure>
<p>è¿™æ—¶ï¼Œæˆ‘ä»¬æ‰§è¡Œ <code>git commit --amend</code> è¿›å…¥æ–‡æœ¬ç¼–è¾‘å™¨ï¼Œå°†ä¿¡æ¯æ›´æ”¹ä¸ºå¦‚ä¸‹å†…å®¹å¹¶ä¿å­˜é€€å‡ºï¼š</p>
<figure data-type="image" tabindex="2"><img src="https://i.loli.net/2019/04/29/5cc6fc5398ed4.jpg" alt="https://i.loli.net/2019/04/29/5cc6fc5398ed4.jpg" loading="lazy"></figure>
<p>å†æ¬¡æ‰§è¡Œ <code>git log</code> å‘ç° git hash ä¸ commit éƒ½å·²ç»å‘ç”Ÿæ”¹å˜</p>
<figure data-type="image" tabindex="3"><img src="https://i.loli.net/2019/04/29/5cc6fc55a2f66.jpg" alt="https://i.loli.net/2019/04/29/5cc6fc55a2f66.jpg" loading="lazy"></figure>
<hr>
<h2 id="ä¿®æ”¹å¤šä¸ªæäº¤ä¿¡æ¯"><strong>ä¿®æ”¹å¤šä¸ªæäº¤ä¿¡æ¯</strong></h2>
<p>å¦‚æœæˆ‘ä»¬æƒ³ä¿®æ”¹ä¸æ­¢å‰ä¸€æ¬¡çš„æäº¤ï¼Œé‚£ä¹ˆå¯ä»¥é€šè¿‡å˜åŸºçš„æ“ä½œä¿®æ”¹ä¸€ç³»åˆ—çš„æäº¤ï¼š<br>
å‘½ä»¤ï¼š<code>git rebase -i</code>è¿›è¡Œäº¤äº’å¼å˜åŸºï¼Œåé¢å¯ä»¥æ¥<code>HEAD~X</code>Xä»£è¡¨æŒ‡å®šä¿®æ”¹å‰Xæ¬¡æäº¤ï¼ˆå¦‚ HEAD~3ï¼‰<br>
ä¹Ÿå¯ä»¥ä»<code>git log</code>ä¸­ç›´æ¥å¤åˆ¶æƒ³è¦ä¿®æ”¹åˆ°å“ªæ¬¡çš„ HASH å€¼ã€‚æ¥ä¸‹æ¥åŒæ ·ä¼šè¿›å…¥æ–‡æœ¬ç¼–è¾‘äº¤äº’ç•Œé¢ï¼Œæ ¹æ®æç¤ºä¿¡æ¯ä¿®æ”¹ç›¸åº”çš„ action åä¿å­˜å³å¯ï¼ˆåé¢æä¾› ğŸŒ°ï¼‰ã€‚<br>
ä¸€èˆ¬ action æœ‰å¦‚ä¸‹ï¼š</p>
<pre><code># Commands:
#  p, pick = use commitï¼ˆé»˜è®¤ optionï¼‰
#  r, reword = use commit, but edit the commit messageï¼ˆå³ä¿®æ”¹ commit ä¿¡æ¯ï¼‰
#  e, edit = use commit, but stop for amendingï¼ˆä¿®æ”¹ commit ä¿¡æ¯ï¼Œå¹¶åœ¨æ¯æ¡ commit ä¿¡æ¯éƒ½ä¼šåœä¸‹æ¥ï¼Œæ­¤æ—¶å¯ä»¥ä¿®æ”¹æ–‡ä»¶å† commitï¼‰
#  s, squash = use commit, but meld into previous commitï¼ˆåˆå¹¶å‰ä¸€æ¬¡æäº¤ç»„æˆæ–°çš„æäº¤ï¼‰
#  f, fixup = like &quot;squash&quot;, but discard this commit's log messageï¼ˆåˆå¹¶ commitï¼Œä¸ç»„æˆæ–°çš„æäº¤ï¼‰
#  x, exec = run command (the rest of the line) using shellï¼ˆæ‰§è¡Œ shell å‘½ä»¤ï¼‰
#  d, drop = remove commitï¼ˆå°†æ­¤æ¡ commit åˆ é™¤ï¼‰
</code></pre>
<p>éœ€è¦æ³¨æ„çš„æ˜¯åœ¨äº¤äº’åˆ—è¡¨å†…çš„ commit ä¿¡æ¯ä¸ git log ä¸­çš„ä¿¡æ¯æ˜¯ç›¸åçš„ï¼Œå› ä¸º git ä¼šé‡æ¼”æäº¤ä¿¡æ¯ï¼Œæ‰€ä»¥æ—§çš„ log ä¼šæ’åœ¨å‰é¢ã€‚</p>
<h3 id="example-2"><strong>Example:</strong></h3>
<p><code>git log</code></p>
<figure data-type="image" tabindex="4"><img src="https://i.loli.net/2019/04/29/5cc6fc58158e2.jpg" alt="https://i.loli.net/2019/04/29/5cc6fc58158e2.jpg" loading="lazy"></figure>
<p>è¿™é‡Œæˆ‘ä»¬æƒ³è¦æ‹†åˆ†ç¬¬ä¸€æ¡ commitï¼Œåˆå¹¶ç¬¬äºŒï¼Œä¸‰æ¡ commit<br>
äºæ˜¯æˆ‘ä»¬æ‰§è¡Œ <code>git rebase -i HEAD~3</code> è¿›å…¥äº¤äº’ç•Œé¢å¯¹å‰ä¸‰æ¡ commit è¿›è¡Œä¿®æ”¹ï¼ˆæ³¨æ„æ˜¯å€’åºï¼‰<br>
ç¬¬ä¸€æ¡ action æ”¹ä¸ºäº† rewordï¼Œå› ä¸ºåé¢çš„ fixup ä¼šæ¥åˆå¹¶ï¼Œè¿™æ—¶æˆ‘ä»¬éœ€è¦ä¿®æ”¹ç¬¬ä¸€æ¡çš„ commit ï¼ˆåˆå¹¶ä¿¡æ¯ï¼‰<br>
ç¬¬äºŒæ¡ action æ”¹ä¸ºäº† fixupï¼Œå®ƒä¼šå°†æ”¹åŠ¨è‡ªåŠ¨åˆå¹¶åˆ°å‰ä¸€ä¸ª commit<br>
ç¬¬ä¸‰æ¡ action æ”¹ä¸ºäº† editï¼Œè¿™æ—¶ rebase ä¼šåœä¸‹æ¥ç­‰å¾…ä¿®æ”¹å®Œæ¯•å¹¶æ‰§è¡Œ <code>git rebase --continue</code> æ¥å®Œæˆï¼Œä¸ºäº†å°†è¿™ä¸ª commit <code>Add file_5.txt and file_6.txt</code> æ‹†ä¸ºä¸¤æ¡ä¿¡æ¯ï¼Œæˆ‘ä»¬éœ€è¦ä¿®æ”¹æœ¬åœ°çš„æ–‡ä»¶å¹¶é‡æ–°è¿›è¡Œ commitã€‚<br>
ç°åœ¨æˆ‘ä»¬ä¿å­˜å¹¶é€€å‡ºç¼–è¾‘å™¨ï¼Œç»§ç»­æ¥ä¸‹æ¥çš„æ“ä½œ<br>
ï¼ˆä¸‹å›¾ä¹Ÿå°è¯äº†ä¸Šé¢è¯´çš„ commit ä¸ git log ä¿¡æ¯ç›¸åï¼Œrebase çš„æ‰§è¡Œæ˜¯æŒ‰ä¸‹å›¾çš„æ‰§è¡Œé¡ºåºï¼Œé™¤äº†èƒ½è‡ªåŠ¨æ‰§è¡Œï¼Œéƒ½å¾—è¿›è¡Œ rebase --continue ç»§ç»­ä¸‹ä¸€ä¸ª actionï¼‰</p>
<figure data-type="image" tabindex="5"><img src="https://i.loli.net/2019/04/29/5cc6fc5b3e55e.jpg" alt="https://i.loli.net/2019/04/29/5cc6fc5b3e55e.jpg" loading="lazy"></figure>
<p>é€€å‡ºåé©¬ä¸Šåˆè¿›å…¥äº†ç¼–è¾‘å™¨ï¼Œè¿˜è®°å¾—æˆ‘ä»¬å‰é¢å°†ç¬¬ä¸€æ¡ action æ”¹æˆäº† reword å—ï¼Ÿè¿™é‡Œæäº¤æˆ‘ä»¬éœ€è¦ä¿®æ”¹çš„ commitï¼ˆåŠ ä¸Šäº†file_4.txtï¼‰å¹¶ä¿å­˜é€€å‡º</p>
<figure data-type="image" tabindex="6"><img src="https://i.loli.net/2019/04/29/5cc6fc5e001eb.jpg" alt="https://i.loli.net/2019/04/29/5cc6fc5e001eb.jpg" loading="lazy"></figure>
<p>ç„¶åæˆ‘ä»¬å¯ä»¥å‘ç° rebase stopped at <code>Add file_5.txt and file_6.txt</code> å³ action ä¸º edit  commit å¹¶ä¸” git log ä¸­ <code>Add file_3.txt and file_4.txt</code> å·²ç»æˆåŠŸåˆå¹¶</p>
<figure data-type="image" tabindex="7"><img src="https://i.loli.net/2019/04/29/5cc6fc6162333.jpg" alt="https://i.loli.net/2019/04/29/5cc6fc6162333.jpg" loading="lazy"></figure>
<p>é‚£ä¹ˆå¦‚ä½•æ‹†åˆ† commit å‘¢ï¼Ÿæˆ‘ä»¬å°±éœ€è¦ä¿®æ”¹æœ¬åœ°æ–‡ä»¶é‡æ–°æäº¤ï¼Œæ­¤æ—¶ git log å¯ä»¥å‘ç°æš‚å­˜åŒºæ˜¯ç©ºçš„ï¼Œå¹¶å·²æäº¤åˆ°ä»£ç ä»“åº“ï¼Œä¸ºäº†æµ‹å›æäº¤ï¼Œæˆ‘ä»¬ç”¨ <code>git reset HEAD^</code> å›é€€åˆ°ä¸Šä¸ªçŠ¶æ€</p>
<figure data-type="image" tabindex="8"><img src="https://i.loli.net/2020/03/03/GRw6VXJUxcpOPBm.png" alt="image.png" loading="lazy"></figure>
<p>è¿™æ—¶å°±å¯ä»¥é‡æ–°è¿›è¡Œ commit æäº¤å•¦</p>
<figure data-type="image" tabindex="9"><img src="https://i.loli.net/2020/03/03/hok3q2OIbTCzGLa.png" alt="image.png" loading="lazy"></figure>
<h2 id="æé†’"><strong>æé†’</strong></h2>
<p>git rebase ç”¨æ—¶ä¸€æ—¶çˆ½ï¼Œä½†åˆ‡è®°é»„é‡‘æ³•åˆ™ï¼Œåœ¨å±äºè‡ªå·±çš„åˆ†æ”¯ä¸Šè¿›è¡Œæ“ä½œå³å¯ï¼Œå¦‚æœåœ¨å…¬å…±åˆ†æ”¯ä¸Šè¿›è¡Œ rebaseï¼Œè‹¥ä½ çš„é˜Ÿå‹æœ¬åœ°å·²ç»æœ‰ä¿å­˜çš„å‰¯æœ¬ï¼Œåˆ†æ”¯åˆè¢«ä½ æ”¹äº†ï¼Œé‚£å°±è¦æ³¨æ„äººèº«å®‰å…¨äº†ã€‚</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[Django admin ç§»é™¤æ›´æ”¹åˆ é™¤æ“ä½œ]]></title>
        <id>https://lesywix.github.io/post/django-admin-yi-chu-geng-gai-shan-chu-cao-zuo/</id>
        <link href="https://lesywix.github.io/post/django-admin-yi-chu-geng-gai-shan-chu-cao-zuo/">
        </link>
        <updated>2020-02-29T15:15:13.000Z</updated>
        <content type="html"><![CDATA[<h2 id="ç§»é™¤-action"><strong>ç§»é™¤ action</strong></h2>
<p>åœ¨ä½ çš„ ModelAdmin ä¸­æ·»åŠ  <code>action = None</code></p>
<hr>
<h2 id="ç§»é™¤æ·»åŠ æŒ‰é’®"><strong>ç§»é™¤æ·»åŠ æŒ‰é’®</strong></h2>
<p>åœ¨ä½ çš„ ModelAdmin ä¸­æ·»åŠ </p>
<pre><code>def has_add_permission(self, request): Â  Â 
		return False
</code></pre>
<hr>
<h2 id="ç§»é™¤åˆ é™¤æŒ‰é’®"><strong>ç§»é™¤åˆ é™¤æŒ‰é’®</strong></h2>
<p>åœ¨ä½ çš„ ModelAdmin ä¸­æ·»åŠ </p>
<pre><code>def has_delete_permission(self, request, obj=None):
 Â return False
</code></pre>
<hr>
<h2 id="ç§»é™¤-savesave-and-continue-editing"><strong>ç§»é™¤ saveï¼Œsave and continue editing</strong></h2>
<p>åœ¨ä½ çš„ ModelAdmin ä¸­æ·»åŠ </p>
<pre><code># hidden save button
READONLY_EXTRA_CONTEXT = {
 Â  Â 'show_save': False,
 Â  Â 'show_save_and_continue': False,
}â€‹
def change_view(self, request, object_id, form_url='',extra_context=READONLY_EXTRA_CONTEXT):
 Â return super(CorrespondentConfigAdmin,self).change_view(request, object_id, form_url,extra_context=extra_context)</code></pre>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[[ç¿»è¯‘] ä½¿ç”¨ Django model é”å¤„ç†å¹¶å‘]]></title>
        <id>https://lesywix.github.io/post/fan-yi-shi-yong-django-model-suo-chu-li-bing-fa/</id>
        <link href="https://lesywix.github.io/post/fan-yi-shi-yong-django-model-suo-chu-li-bing-fa/">
        </link>
        <updated>2020-02-23T13:20:59.000Z</updated>
        <content type="html"><![CDATA[<h2 id="é€ æˆå¹¶å‘é—®é¢˜çš„åŸå› "><strong>é€ æˆå¹¶å‘é—®é¢˜çš„åŸå› ï¼š</strong></h2>
<p>å‡è®¾æˆ‘ä»¬çš„ model å®šä¹‰å¦‚ä¸‹ï¼š</p>
<pre><code class="language-python">    class Account(models.Model):
        id = models.AutoField(
            primary_key=True,
        )
        user = models.ForeignKey(
            User,
        )
        # èµ„äº§
        balance = models.IntegerField(
            default=0,
        )
</code></pre>
<p>å¹¶ä¸”æœ‰å¦‚ä¸‹çš„é€»è¾‘æ“ä½œï¼š</p>
<pre><code class="language-python">    # å…¥é‡‘
    def deposit(self, amount):
        self.balance += amount
        self.save()
    # å‡ºé‡‘
    def withdraw(self, amount):
        if amount &gt; self.balance:
            raise errors.InsufficientFunds()
        self.balance -= amount
        self.save()
</code></pre>
<p>å¦‚æœæ˜¯ä¸²è¡Œï¼Œä¸Šé¢çš„é€»è¾‘ä¸ä¼šå‡ºä»€ä¹ˆé—®é¢˜ï¼Œä½†æ˜¯å¦‚æœæ˜¯å¹¶è¡Œçš„è¯ï¼Œå°±æœ‰é—®é¢˜äº†ï¼š<br>
å‡è®¾ç°åœ¨æœ‰ user A å’Œ user B åŒæ—¶å¯¹ balanceï¼ˆåˆå§‹å€¼ä¸º 100ï¼‰ è¿›è¡Œæ“ä½œ</p>
<ol>
<li>user A è·å–åˆ° Account objï¼Œæ­¤æ—¶ balance ä¸º 100</li>
<li>user B è·å–åˆ° Account objï¼Œæ­¤æ—¶ balance ä¸º 100</li>
<li>user A è¿›è¡Œ deposit(50)ï¼Œæ­¤æ—¶ balance ä¸º 100 + 50 = 150</li>
<li>user B è¿›è¡Œ withdraw(30)ï¼Œæ­¤æ—¶ balance ä¸º 100 - 30 = 70</li>
</ol>
<p>user A å­˜å…¥äº† 50ï¼Œuser B æ‹¿å‡ºäº†30ï¼Œæˆ‘ä»¬æœŸæœ›çš„ç»“æœæ˜¯ 120ï¼Œæœ€åç»“æœæ˜¯ 70ï¼Œæ‰€ä»¥é—®é¢˜å°±æ¥äº†ã€‚ç”±äºå¹¶å‘çš„åŸå› ï¼ŒB è¿›è¡Œæ“ä½œçš„æ—¶å€™ï¼Œè·å–åˆ°çš„ Account obj ä¸ A æ˜¯ç›¸åŒçš„ï¼ˆåœ¨ A è·å–åˆ° Account obj ä½†å°šæœªå¯¹å…¶è¿›è¡Œæ“ä½œä¿å­˜æ—¶ï¼‰ï¼Œæ‰€ä»¥ A è¿›è¡Œçš„æ“ä½œå¯¹ B å¹¶æ²¡æœ‰ä»€ä¹ˆå½±å“ã€‚</p>
<h2 id="è§£å†³æ–¹æ³•"><strong>è§£å†³æ–¹æ³•</strong></h2>
<h3 id="æ‚²è§‚é”"><strong>æ‚²è§‚é”</strong></h3>
<p>å³åœ¨è¯·æ±‚å¯¹èµ„æºè¿›è¡Œæ“ä½œçš„æ—¶å€™ï¼Œé”ä½è¦æ“ä½œçš„èµ„æºï¼Œç›´åˆ°æ•´ä¸ªæ“ä½œç»“æŸåˆ™é‡Šæ”¾é”ã€‚</p>
<p>åœ¨è¿™é‡Œæ¨èç”¨æ•°æ®åº“çº§åˆ«çš„é”ï¼Œå› ä¸ºæ•°æ®åº“èƒ½å¾ˆå¥½åœ°ç®¡ç†é”å¤„ç†å¹¶å‘ï¼Œè€Œä¸”ä½å±‚é¢çš„é”ä¸ä¼šå› ä¸ºå…¶ä»–è¿›ç¨‹æˆ–è€…çº¿ç¨‹çš„æ“ä½œå—åˆ°å½±å“ï¼Œå¦å¤– Django App å¯ä»¥è·‘å¤šè¿›ç¨‹ï¼Œç»´æŠ¤ App çº§åˆ«çš„é”å·¥ä½œé‡éå¸¸å¤§ä¸”å¤æ‚ã€‚</p>
<p>å¯¹äº Django æˆ‘ä»¬å¯ä»¥ç”¨ <code>select_for_update()</code> çš„æ–¹å¼é”ä½æˆ‘ä»¬è¦æ“ä½œçš„ objï¼ˆå¯¹äºæ•°æ®åº“åˆ™æ˜¯é”ä½è¦æ“ä½œçš„è¡Œï¼‰ å¦‚ï¼šaccount_obj = Account.objects.select_for_update().get(id=1),è¿™æ ·è·å–åˆ°çš„ obj å°±æ˜¯æœ‰å¸¦é”çš„ï¼Œå…¶ä»–è¯·æ±‚æƒ³è¦å¯¹è¿™ä¸ªèµ„æºè¿›è¡Œè®¿é—®éœ€è¦ç­‰å¾…è¿™ä¸ª obj å®Œæˆæ‰èƒ½è®¿é—®ã€‚<br>
å‚è§æ–‡æ¡£ï¼š<a href="https://docs.djangoproject.com/en/dev/ref/models/querysets/#select-for-update">https://docs.djangoproject.com/en/dev/ref/models/querysets/#select-for-update</a></p>
<p>è¿™é‡Œæœ‰å‡ ç‚¹éœ€è¦æ³¨æ„ï¼š</p>
<ol>
<li>éœ€è¦åœ¨åŸå­æ“ä½œï¼ˆatomicï¼‰ä¸­ä½¿ç”¨ <code>select_for_update()</code> (åŸå­æ“ä½œç»“æŸæ‰é‡Šæ”¾é”)</li>
<li>è‹¥ä¸éœ€è¦ç­‰å¾…å¯ä»¥å¸¦ä¸Š <code>nowait=True</code> çš„å‚æ•°ï¼Œé‡åˆ°å†²çªçš„èµ„æºç›´æ¥ raise DatabaseError</li>
<li>è‹¥åŒæ—¶ä½¿ç”¨äº† <code>select_related</code>ï¼Œåˆ™ç›¸å…³èµ„æºä¹Ÿä¼šåŠ ä¸Šé”</li>
</ol>
<p>ä¸Šé”ä»£ç ï¼š</p>
<pre><code class="language-python">    @classmethod
    def deposit(cls, id, amount):
       with transaction.atomic():
           account = (
               cls.objects
               .select_for_update()
               .get(id=id)
           )
          
           account.balance += amount
           account.save()
        return account
    
    @classmethod
    def withdraw(cls, id, amount):
       with transaction.atomic():
           account = (
               cls.objects
               .select_for_update()
               .get(id=id)
           )
          
           if account.balance &lt; amount:
               raise errors.InsufficentFunds()
           account.balance -= amount
           account.save()
      
       return account
</code></pre>
<h3 id="ä¹è§‚é”"><strong>ä¹è§‚é”</strong></h3>
<p>å³åœ¨è·å–èµ„æºçš„æ—¶å€™å¹¶ä¸ä¼šå¯¹ç›¸å…³èµ„æºä¸Šé”ï¼Œè€Œæ˜¯åŠ ä¸Šä¸€ä¸ªå­—æ®µ versionï¼Œåœ¨å…¥åº“çš„æ—¶å€™é€šè¿‡åˆ¤æ–­ version ä¿è¯èµ„æºæ›´æ–°ä¸å†²çªã€‚</p>
<p>ä¸¾ä¸ªä¾‹å­ï¼š<br>
æ•°æ®è¡¨ä¸­æœ‰ version å­—æ®µï¼Œè¦å¯¹æŸä¸€èµ„æºè¯·æ±‚çš„æ—¶å€™ï¼Œæ•°æ®éœ€è¦å¸¦ä¸Š versionï¼Œç„¶åç”¨ version æŸ¥è¯¢æ•°æ®åº“ï¼Œæ­¤æ—¶è‹¥æœ‰ä¸¤ä¸ªå¹¶å‘è¯·æ±‚ï¼Œè·å–åˆ°çš„ obj åº”è¯¥æ˜¯ä¸€æ ·çš„ï¼Œç„¶åè¿™ä¸¤ä¸ªè¯·æ±‚åŒæ—¶ä¿®æ”¹æ•°æ®ï¼Œå¹¶å°† version è‡ªå¢ 1ï¼Œåœ¨ä¿å­˜çš„æ—¶å€™ï¼Œä¹Ÿå…ˆæŸ¥è¯¢æ•°æ®åº“ä¸­å­˜ä¸å­˜åœ¨ POST è¿‡æ¥çš„ versionï¼Œå­˜åœ¨åˆ™ saveï¼Œä¸å­˜åœ¨è¯´æ˜è¯¥ version å·²ç»è¢«åˆ«äººå…ˆä¿®æ”¹äº†ï¼Œversion åº”è¯¥å·²ç»å¢åŠ  1ï¼Œæ‰€ä»¥è¿”å›ä¿®æ”¹å¤±è´¥ã€‚<br>
ç”¨ Django è¡¨è¾¾å°±æ˜¯ <code>Model.Object.filter(version=version).update(data=data, version=version + 1)</code><br>
è¿”å› 1 ä»£è¡¨ update äº†ä¸€è¡Œï¼Œ0 ä»£è¡¨å¤±è´¥</p>
<p>è¿™é‡Œä¹Ÿæœ‰å‡ ç‚¹éœ€è¦æ³¨æ„ï¼š</p>
<ol>
<li>éœ€è¦æ·»åŠ å¤šä¸€ä¸ªå­—æ®µï¼Œå¹¶å¢åŠ é€»è¾‘åˆ¤æ–­</li>
<li>å¦‚æœæœ‰å¾ˆå¤šå¹¶å‘æ“ä½œï¼Œä¼šé€ æˆå¾ˆå¤šè¯·æ±‚å¤±è´¥ï¼Œå› ä¸ºä»–ä¼šè¿”å›æ“ä½œå¤±è´¥è€Œä¸æ˜¯åƒæ‚²è§‚é”é‚£æ ·ä¼šç­‰å¾…è¯·æ±‚</li>
<li>éœ€è¦æ³¨æ„åœ¨ç¨‹åºå¤–å¯¹æ•°æ®è¿›è¡Œæ“ä½œå¯èƒ½ä¼šé€ æˆå†²çªï¼Œæ¯”å¦‚åœ¨ Django shell ä¸­ï¼Œè‹¥æ²¡åŠ ä¸Šé€»è¾‘åˆ¤æ–­å¯¹ model è¿›è¡Œæ›´æ–°</li>
<li>ç”±äºä¸åƒæ‚²è§‚é”æœ‰ <code>no_wait = False</code> å¯ä»¥å®ç°å†²çªç­‰å¾…ï¼Œæ‰€ä»¥ä½¿ç”¨ä¹è§‚é”å¯èƒ½éœ€è¦è‡ªå·±å®ç°å¤±è´¥é‡è¯•æœºåˆ¶</li>
</ol>
<p>ä¸Šé”ä»£ç ï¼š</p>
<pre><code class="language-python">    def deposit(self, id, amount):
       updated = Account.objects.filter(
           id=self.id,
           version=self.version,
       ).update(
           balance=balance + amount,
           version=self.version + 1,
       )
       return updated &gt; 0
    def withdraw(self, id, amount):       
       if self.balance &lt; amount:
           raise errors.InsufficentFunds()
      
       updated = Account.objects.filter(
           id=self.id,
           version=self.version,
       ).update(
           balance=balance - amount,
           version=self.version + 1,
       )
      
       return updated &gt; 0
</code></pre>
<h3 id="ä»€ä¹ˆæ—¶å€™ç”¨ä¹è§‚é”ä»€ä¹ˆæ—¶å€™ç”¨æ‚²è§‚é”">ä»€ä¹ˆæ—¶å€™ç”¨ä¹è§‚é”ï¼Œä»€ä¹ˆæ—¶å€™ç”¨æ‚²è§‚é”</h3>
<ul>
<li>å¦‚æœæ“ä½œå¯¹è±¡æœ‰è®¸å¤šå¹¶å‘æ›´æ–°ï¼ˆå†™æ“ä½œå¤šï¼‰ï¼Œç”¨æ‚²è§‚é”å¯èƒ½æ›´å¥½ï¼›æ“ä½œå¯¹è±¡è¯»æ“ä½œå¤šå†™æ“ä½œå°‘ï¼Œç”¨ä¹è§‚é”æ›´å¥½</li>
<li>å¦‚æœæ›´æ–°å‘ç”Ÿåœ¨ç¨‹åºä¹‹å¤–(ä¾‹å¦‚ï¼Œç›´æ¥åœ¨æ•°æ®åº“ä¸­æˆ– manage shell ä¸­)ï¼Œæ‚²è§‚é”æ›´å®‰å…¨</li>
<li>å¦‚æœæ¥å£è¢«è¿œç¨‹åº”ç”¨æˆ–æ“ä½œç³»ç»Ÿè°ƒç”¨å¹¶ä¸”æœ‰å‰¯ä½œç”¨ï¼Œéœ€è¦è¯·ç¡®ä¿å®ƒä»¬çš„æ“ä½œå®‰å…¨ã€‚æ¯”å¦‚è°ƒç”¨æ˜¯å¦ä¼šèŠ±å¾ˆé•¿æ—¶é—´å¯¼è‡´è¶…æ—¶ï¼Ÿæ¯æ¬¡è°ƒç”¨æ˜¯å¦èƒ½ä¿è¯å¹‚ç­‰ï¼Ÿ</li>
</ul>
<hr>
<p>åŸæ–‡å‡ºå¤„ï¼š <a href="https://medium.com/@hakibenita/how-to-manage-concurrency-in-django-models-b240fed4ee2">https://medium.com/@hakibenita/how-to-manage-concurrency-in-django-models-b240fed4ee2</a></p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[è‡ªå®šä¹‰ Django models import æ–¹å¼]]></title>
        <id>https://lesywix.github.io/post/zi-ding-yi-django-models-import-fang-shi/</id>
        <link href="https://lesywix.github.io/post/zi-ding-yi-django-models-import-fang-shi/">
        </link>
        <updated>2020-02-23T06:05:24.000Z</updated>
        <content type="html"><![CDATA[<p>é»˜è®¤çš„ï¼Œæˆ‘ä»¬ä¼šæŠŠ Django models æ”¾åˆ°ä¸€ä¸ªä½¿ç”¨ startapp åˆ›å»ºçš„ app çš„ç›®å½•ä¸‹ï¼Œç„¶ååœ¨ settings ä¸­çš„ INSTALLED_APPS å†™å…¥è¿™ä¸ª appï¼Œåœ¨è¿è¡Œ Django æˆ–è€…åš migrate æ—¶ï¼Œ Django å°±ä¼šè‡ªåŠ¨å‘ç°è¯¥ app ä¸‹çš„ modelsï¼Œå¹¶åœ¨ showmigrations ä¸­æ˜¾ç¤ºã€‚</p>
<p>ä½†æ˜¯å¦‚æœæˆ‘ä»¬éœ€è¦å°†åŸæ¥åˆ†æ•£åœ¨å„ä¸ª Apps ä¸­çš„æ‰€æœ‰ models æ”¾åˆ°åŒä¸€ä¸ª app çš„å­ç›®å½•ä¸‹ï¼Œä¾‹å¦‚åŸæ¥ models ç»“æ„å¯èƒ½æ˜¯ <code>project/account_app/models.py</code>ï¼Œæˆ‘ä»¬æƒ³æ”¹æˆ <code>project/appcore/account/models.py</code> ã€‚è¿™æ—¶å€™ Django å°±ä¼šå‘ç°ä¸äº†è¿™äº› models äº†ï¼ˆæ— æ³• makemigrationsï¼‰ã€‚å¦‚ä½•æ‰èƒ½è®© Django å‘ç°è¿™äº›è¿™äº› models å‘¢ï¼Ÿ</p>
<p>å…ˆæ¥çœ‹çœ‹ Django æºç ä¸­ app ä¸­çš„å±æ€§ (django/apps/config.py)ï¼š</p>
<figure data-type="image" tabindex="1"><img src="https://i.loli.net/2019/04/29/5cc6fd0a11f8b.jpg" alt="https://i.loli.net/2019/04/29/5cc6fd0a11f8b.jpg" loading="lazy"></figure>
<p>å¯ä»¥çœ‹å‡º all_models åº”è¯¥å°±æ˜¯è¯¥ app ä¸­çš„æ‰€æœ‰ modelsï¼Œæ­¤å¤–æˆ‘ä»¬è¿˜å¯ä»¥å‘ç°è¯¥ç±»ä¸­æœ‰ä¸ª import_models() æ–¹æ³•ï¼Œå¯ä»¥çœ‹å‡º models_module_name ä¸º app_name.modelsï¼Œå³æ¯ä¸ª app ä¸‹çš„ models æ–‡ä»¶ï¼Œå·²ç»å†™æ­»åœ¨è¿™å„¿äº†ã€‚</p>
<figure data-type="image" tabindex="2"><img src="https://i.loli.net/2019/04/29/5cc6fd0c46761.jpg" alt="https://i.loli.net/2019/04/29/5cc6fd0c46761.jpg" loading="lazy"></figure>
<p>æŸ¥çœ‹å¼•ç”¨äº† import_models çš„æ–‡ä»¶ï¼ˆregistry.pyï¼‰</p>
<figure data-type="image" tabindex="3"><img src="https://i.loli.net/2019/04/29/5cc6fd0e31c22.jpg" alt="https://i.loli.net/2019/04/29/5cc6fd0e31c22.jpg" loading="lazy"></figure>
<p>ä¼ å…¥çš„ all_models å³ models ä¸­çš„æ¯ä¸ªç±»ï¼Œç„¶åä¼ ç»™ config.py åˆå§‹åŒ– models_moduleã€‚</p>
<p>å½“ model è¢« import çš„æ—¶å€™ï¼Œ ModelBase.<strong>new</strong> éƒ½ä¼šè°ƒç”¨ apps.register_model é€šè¿‡å‚æ•° all_models æ¥åˆ›å»ºè¿™ä¸ª app å¯¹åº”çš„ modelsã€‚</p>
<p>æ‰€ä»¥æƒ³è¦åœ¨å­ç›®å½•ä¸­å¼•å…¥ modelsï¼Œæˆ‘ä»¬éœ€è¦æ”¹å˜ models_module å†™æ­»çš„èµ‹å€¼æ–¹å¼ã€‚</p>
<p>æ¯”å¦‚æˆ‘ä»¬æœ‰ä¸ª app å« appcoreï¼Œå­˜æ”¾æ‰€æœ‰çš„ modelsï¼Œç›®å½•ç»“æ„å¦‚ä¸‹ï¼š</p>
<pre><code class="language-bash">    .
    â”œâ”€â”€ README.md
    â”œâ”€â”€ myproject
    â”‚Â Â  â”œâ”€â”€ __init__.py
    â”‚Â Â  â”œâ”€â”€ admin.py
    â”‚Â Â  â”œâ”€â”€ settings.py
    â”‚Â Â  â”œâ”€â”€ urls.py
    â”‚Â Â  â”œâ”€â”€ views
    â”‚Â Â  â””â”€â”€ wsgi.py
    â”œâ”€â”€ appcore
    â”‚Â Â  â”œâ”€â”€ __init__.py
    â”‚Â Â  â”œâ”€â”€ account
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ __init__.py
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ api.py
    â”‚Â Â  â”‚Â Â  â””â”€â”€ models.py
    â”‚Â Â  â”œâ”€â”€ apps.py
    â”‚Â Â  â”œâ”€â”€ base
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ __init__.py
    â”‚Â Â  â”‚Â   â”œâ”€â”€ api.py
    â”‚Â Â  â”‚Â Â  â””â”€â”€ models.py
    â”‚Â Â  â”œâ”€â”€ comment
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ __init__.py
    â”‚Â Â  â”‚Â Â  â””â”€â”€ models.py
</code></pre>
<p>å¯ä»¥åœ¨ apps.py ä¸­è¦†ç›– import_models æ–¹æ³•</p>
<pre><code class="language-python">    # apps.py
    from __future__ import unicode_literals
    import django
    from django.apps import AppConfig
    from importlib import import_module
    from distutils.version import StrictVersion
    
    # sub module
    SUBAPPS = [
        'account',
        'base',
        'commen'
    ]
    
    class AppCoreConfig(AppConfig):
        name = 'appcore'
        # django 1.11 å all_models è·å–æ–¹å¼æœ‰å˜åŒ–ï¼Œå› æ­¤åŠ ä¸ªåˆ¤æ–­
        if StrictVersion(django.get_version()) &gt;= StrictVersion('1.11'):
            def import_models(self):
                self.models = self.apps.all_models[self.label]
                self._import_models()
        else:
            # compatibility for django &lt; 1.11
            def import_models(self, all_models):
                self.models = all_models
                self._import_models()
        # æ·»åŠ å­ç›®å½•ä¸­çš„ models
        def _import_models(self):
            models_module = None
            for i in SUBAPPS:
                models_module_name = '{}.{}.models'.format(self.name, i)
                models_module = import_module(models_module_name)
            # æœ€åé‡æ–°èµ‹å€¼
            self.models_module = models_module
</code></pre>
<p>ç„¶ååœ¨ settings ä¸­æ·»åŠ æ­¤ appï¼ˆappcoreï¼‰ï¼Œ è¿™æ ·å°±èƒ½è¢« Django å‘ç°è¯¥ç›®å½•ä¸‹çš„æ‰€æœ‰ models äº†ã€‚</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[è£…é¥°å™¨æ‰§è¡Œé¡ºåº]]></title>
        <id>https://lesywix.github.io/post/zhuang-shi-qi-zhi-xing-shun-xu/</id>
        <link href="https://lesywix.github.io/post/zhuang-shi-qi-zhi-xing-shun-xu/">
        </link>
        <updated>2020-02-21T10:03:01.000Z</updated>
        <content type="html"><![CDATA[<p>è€ƒè™‘å¦‚ä¸‹ä»£ç æ‰§è¡Œé¡ºåºï¼š</p>
<pre><code class="language-python">def decorator_a(func):
    print('Get in decorator_a')
    
    def inner_a(*args, **kwargs):
        print('Get in inner_a')
        return func(*args, **kwargs)
    return inner_a
    
    
def decorator_b(func):
    print('Get in decorator_b')
    
    def inner_b(*args, **kwargs):
        print('Get in inner_b')
        return func(*args, **kwargs)
    return inner_b
    
    
@decorator_a
@decorator_b
def f(x):
    print('Get in f')
    return x * 2
    
    
 f(1)
</code></pre>
<p>ç»“æœä¸ºï¼š</p>
<pre><code>Get in decorator_b
Get in decorator_a
Get in inner_a
Get in inner_b
Get in f
</code></pre>
<p>æˆ‘ä»¬çŸ¥é“ï¼Œç”¨è¯­æ³•ç³–çš„è£…é¥°å™¨æˆ‘ä»¬å¯ä»¥å°†è¢«è£…é¥°çš„å‡½æ•°è½¬æ¢ä¸º</p>
<pre><code class="language-python">def f(x):
    print('Get in f')
    return x * 2
f = decorator_a(decorator_b(f))  # decorator å®šä¹‰çœç•¥
    
# è°ƒç”¨ f å‡½æ•°
f(1)
</code></pre>
<p>å› æ­¤ï¼Œå½“æ‰§è¡Œåˆ° <code>f = decorator_a(decorator_b(f))</code> æ—¶ï¼Œå…ˆæ‰§è¡Œäº† <code>decorator_b(f)</code> ï¼Œè¾“å‡º <code>Get in decorator_b</code> å¹¶è¿”å› <code>inner_b</code> å‡½æ•°ï¼Œç„¶åä¼ é€’ç»™ <code>decorator_a</code> ä½œä¸ºå‚æ•°ï¼Œå³ <code>decorator_a(inner_b)</code> ï¼Œè¾“å‡º <code>Get in decorator_a</code> å¹¶è¿”å› <code>inner_a</code> å‡½æ•°ã€‚</p>
<p>å½“æ‰§è¡Œåˆ° <code>f(1)</code> è°ƒç”¨ f å‡½æ•°æ—¶ï¼Œç›¸å½“äºæ‰§è¡Œäº† <code>decorator_a(decorator_b(f))(1)</code> ã€‚ç”±å‰é¢å¾—çŸ¥ <code>decorator_a(decorator_b(f))</code> è¿”å›äº† <code>inner_a</code> å‡½æ•°ï¼Œæ‰€ä»¥ <code>decorator_a(decorator_b(f))(1)</code> ç­‰ä»·äº <code>inner_a(1)</code> ï¼Œäºæ˜¯è¿›å…¥åˆ° <code>inner_a</code> å‡½æ•°è¾“å‡º <code>Get in inner_a</code> å¹¶æ‰§è¡Œå‡½æ•°å†…çš„ <code>func(*args, **kwargs)</code>ï¼Œè¿™é‡Œ <code>func</code> å³ä¸º <code>decorator_a</code> çš„å‚æ•°ï¼š<code>decorator_b(f)</code> ï¼Œå³ <code>func(*args, **kwargs) -&gt; decorator_b(f)(1) -&gt; inner_b(1)</code>  ï¼Œæ‰€ä»¥ç±»ä¼¼äºå‰é¢åŒæ ·çš„é€»è¾‘ï¼Œè¿›å…¥åˆ° <code>inner_b</code> å‡½æ•°è¾“å‡º <code>Get in inner_b</code> å¹¶æ‰§è¡Œ <code>func(*args, **kwargs)</code>ï¼Œè¿™é‡Œ <code>func</code> å³ä¸º f å‡½æ•°ï¼Œæ‰€ä»¥æœ€åè¿›å…¥ f å‡½æ•°ï¼Œè¾“å‡º <code>Get in f</code> ã€‚</p>
<p>å‰é¢çš„é€»è¾‘çœ‹èµ·æ¥æœ‰ç‚¹ç»•ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ç”¨æ ˆçš„æ€æƒ³æ¥ç†è§£ï¼šåœ¨å®šä¹‰è£…é¥°å™¨å‡½æ•°çš„æ—¶å€™ï¼Œç›¸å½“äºå‡½æ•°å…¥æ ˆï¼Œä¸Šé¢çš„ä¾‹å­å°±æ˜¯ <code>f -&gt; decorator_b -&gt; decorator_a</code>ï¼›åœ¨è¢«è°ƒç”¨çš„åœ°æ–¹ï¼Œç›¸å½“äºå‡½æ•°å‡ºæ ˆ <code>decorator_a -&gt; decorator_b -&gt; f</code> ã€‚</p>
<p>ç”±ä¸Šé¢çš„ä¾‹å­ï¼Œæˆ‘ä»¬å†æ¥æ€è€ƒä¸€ä¸‹ä¸‰å±‚åµŒå¥—çš„è£…é¥°å™¨ï¼ˆå³åŒ…å«è£…é¥°å™¨æœ¬èº«çš„å‚æ•°ï¼‰çš„è¾“å‡ºæƒ…å†µï¼š</p>
<pre><code class="language-python">def decorator_a(n):
    print(f'Get in decorator_a, n: {n}')
    
    def middle_a(func):
        print('Get in middle_a')
    
        def inner_a(*args, **kwargs):
            print('Get in inner_a')
            return func(*args, **kwargs)
        return inner_a
    return middle_a
    
    
def decorator_b(n):
    print(f'Get in decorator_b, n: {n}')
    
    def middle_b(func):
        print('Get in middle_b')
    
        def inner_b(*args, **kwargs):
            print('Get in inner_b')
            return func(*args, **kwargs)
        return inner_b
    return middle_b
    
    
@decorator_a('a')
@decorator_b('b')
def f(x):
    print('Get in f')
    return x * 2
    
    
f(1)
</code></pre>
<p>ç»“æœä¸ºï¼š</p>
<pre><code>Get in decorator_a, n: a
Get in decorator_b, n: b
Get in middle_b
Get in middle_a
Get in inner_a
Get in inner_b
Get in f
</code></pre>
<p>å¯¹äºä¸‰å±‚åµŒå¥—ç»“æ„ï¼Œæˆ‘ä»¬åŒæ ·å¯ä»¥å°†è¯­æ³•ç³–å½¢å¼è½¬æ¢ä¸ºå‡½æ•°å½¢å¼ã€‚ä¸Šé¢çš„ä¾‹å­å¯ä»¥å†™ä¸º:</p>
<pre><code class="language-py">def f(x):
    print('Get in f')
    return x * 2
f = decorator_a(n)(decorator_b(n)(f))  # decorator å®šä¹‰çœç•¥
    
# è°ƒç”¨ f å‡½æ•°
f(1)
</code></pre>
<p>ä¸ä¸¤å±‚åµŒå¥—ä¸åŒçš„æ˜¯ï¼Œä¸‰å±‚åµŒå¥—åœ¨åŒ…è£…æ—¶å·²ç»è°ƒç”¨äº†æœ€å¤–å±‚ï¼Œå¹¶è¿”å›å†…å±‚å‡½æ•°ï¼ˆå…ˆå‰¥å¼€äº†æœ€å¤–å±‚ï¼Œå¹¶è¿”å›å‰©ä¸‹çš„å†…å®¹ï¼Œå‰©ä¸‹çš„å†…å®¹ä¸éš¾å‘ç°ä¸äºŒå±‚è£…é¥°å™¨ç›¸åŒï¼‰ã€‚å¦‚æœæˆ‘ä»¬åªçœ‹ä¸€ä¸ªè£…é¥°å™¨çš„è¯ï¼Œå³ <code>f = decorator_a(n)(f)</code> æ‰€ä»¥ä¼šå…ˆè°ƒç”¨è£…é¥°å™¨ï¼Œè¿›å…¥è£…é¥°å™¨æœ€å¤–å±‚å¹¶è¾“å‡º <code>Get in decorator_a, n: a</code> ï¼Œç„¶åè¿”å›é‡Œé¢ä¸¤å±‚ç»“æ„ï¼ˆåé¢çš„åˆ†æå°±ä¸å‰ä¸€ä¸ªä¾‹ä¸€æ ·äº†ï¼‰</p>
]]></content>
    </entry>
</feed>